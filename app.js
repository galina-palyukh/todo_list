document.addEventListener("DOMContentLoaded", function () {    let body = document.querySelector("body");    let table = document.querySelector(".table-todo");    let tableBody = document.querySelector(".table-todo tbody");    let addBtn = document.querySelector(".box-add__btn");    let addInput = document.querySelector(".box-add__field");    let filterOptions = document.querySelector(".select-sort-task");    let commonInputStatus = document.querySelector(".table-todo__status-common-input");    let btnRemoveAllTasks = document.querySelector(".todo-header__btn-remove-all");    //localStorage    let taskCommonStatus = JSON.parse((localStorage.getItem("taskCommonStatusKey")) || false);    let dynamicDateArr = JSON.parse(localStorage.getItem("rowsKey")) || [];    //END localStorage    if (dynamicDateArr.length !== 0) {        table.style.display = "table";    }    for (let i = 0; i < dynamicDateArr.length; i++) {        addTableRow(dynamicDateArr[i]);    }    addBtn.addEventListener("click", onclickAddTaskButton);    addInput.addEventListener("keypress", function (keyEvent) {        if (keyEvent.key === "Enter") {            onclickAddTaskButton();        }    });    filterOptions.addEventListener("change", filterTasks);    function filterTasks(e) {        if (e.target.value === "completed") {            let allTasks = tableBody.querySelectorAll("tr");            // for(const task of allTasks){            //            // }            alert(allTasks);        }    }    btnRemoveAllTasks.addEventListener("click", removeAllTasks);    function removeAllTasks() {        let rows = tableBody.querySelectorAll(".table-todo__row");        for (const tr of rows) {            tr.remove();        }        dynamicDateArr.length = 0;        localStorage.setItem("rowsKey", JSON.stringify(dynamicDateArr));        table.style.display = "none";    }    function addTableRow(rowVariable) {        let row = document.createElement("tr");        row.classList.add("table-todo__row");        tableBody.appendChild(row);        let cellStatus = document.createElement("td");        cellStatus.classList.add("table-todo__cell");        row.appendChild(cellStatus);        let boxStatus = document.createElement("div");        boxStatus.classList.add("table-todo__status");        cellStatus.appendChild(boxStatus);        let inputStatus = document.createElement("input");        inputStatus.classList.add("table-todo__status-input");        boxStatus.appendChild(inputStatus);        inputStatus.setAttribute("type", "checkbox");        inputStatus.checked = rowVariable.status;        inputStatus.addEventListener("change", doneTask);        if (rowVariable.status === true) row.classList.add("_done");        //for common checkbox status        commonInputStatus.checked = taskCommonStatus;        //end for common checkbox status        let cellTitle = document.createElement("td");        cellTitle.classList.add("table-todo__cell");        row.appendChild(cellTitle);        let boxTitle = document.createElement("div");        boxTitle.classList.add("table-todo__title");        cellTitle.appendChild(boxTitle);        boxTitle.innerText = rowVariable.title;        let cellDate = document.createElement("td");        cellDate.classList.add("table-todo__cell");        row.appendChild(cellDate);        let boxDate = document.createElement("div");        boxDate.classList.add("table-todo__date");        cellDate.appendChild(boxDate);        boxDate.textContent = rowVariable.date;        let actions = document.createElement("td");        actions.classList.add("table-todo__cell");        actions.innerHTML = '<div class="table-todo__actions"><a href ="#" class="table-todo__btn table-todo__btn-remove"><i class="fa-solid fa-trash"></i></a><a href ="#" class="table-todo__btn table-todo__btn-edit"><i class="fa-solid fa-pen-to-square"></i></a></div>';        row.appendChild(actions);        let removeBtn = actions.querySelector(".table-todo__btn-remove");        removeBtn.addEventListener("click", removeTask);        let editBtn = actions.querySelector(".table-todo__btn-edit");        editBtn.addEventListener("click", editTask);    }    function onclickAddTaskButton(e) {        if (e) {            e.preventDefault();        }        let value = addInput.value.trim();        let optionsDate = {            year: 'numeric',            month: '2-digit',            day: '2-digit'        };        let dateString = new Date().toLocaleDateString("en-GB", optionsDate);        let timeString = new Date().toLocaleTimeString("en-GB");        let date = dateString + " " + timeString;        let status = false;        if (value !== "") {            if (table.style.display !== "table") {                table.style.display = "table";            }            let rowObj = {                status: status,                title: value,                date: date,            };            addTableRow(rowObj);            commonInputStatus.checked = false;            taskCommonStatus = false;            localStorage.setItem('taskCommonStatusKey', JSON.stringify(taskCommonStatus));            dynamicDateArr.push(rowObj);            localStorage.setItem('rowsKey', JSON.stringify(dynamicDateArr));            document.querySelector(".box-add__field").value = " ";        }    }    function doneTask(e) {        let row = this.closest("tr");        this.checked === true ? row.classList.add("_done") : row.classList.remove("_done");        let indexRow = [...tableBody.childNodes].indexOf(row);        dynamicDateArr[indexRow].status = this.checked;        if (dynamicDateArr.some(el => el.status === false)) {            commonInputStatus.checked = false;            taskCommonStatus = false;        } else if (dynamicDateArr.every(el => el.status === true)) {            commonInputStatus.checked = true;            taskCommonStatus = true;        }        localStorage.setItem('taskCommonStatusKey', JSON.stringify(taskCommonStatus));        localStorage.setItem('rowsKey', JSON.stringify(dynamicDateArr));    }    function removeTask(e) {        e.preventDefault();        let row = this.closest("tr");        let rowsList = tableBody.childNodes;        let indexRow = [...rowsList].indexOf(row);        row.remove();        dynamicDateArr.splice(indexRow,1);        localStorage.setItem("rowsKey", JSON.stringify(dynamicDateArr));        if (dynamicDateArr.length === 0) {            table.style.display = "none";        }    }    let popupEdit = document.querySelector(".edit-task-popup");    let editPopupBtnSubmit = document.querySelector(".edit-task-popup__btn-submit");    let editPopupBtnCancel = document.querySelector(".edit-task-popup__btn-cancel");    let editPopupBtnClose = document.querySelector(".edit-task-popup__btn-close");    let editPopupField = document.querySelector(".edit-task-popup__field");    let editPopupOverlay = document.querySelector(".edit-task-popup .popup__overlay");    let editButtonClicked;    function editTask(e) {        e.preventDefault();        editButtonClicked = this;        let row = editButtonClicked.closest("tr");        let title = row.querySelector(".table-todo__title").innerHTML;        openEditPopup(title);    }    editPopupBtnSubmit.addEventListener("click", editTaskSaveState);    editPopupField.addEventListener("keypress", (e) => {        if (e.key === "Enter") {            editTaskSaveState();        }    });    function editTaskSaveState() {        let row = editButtonClicked.closest("tr");        let rowsList = tableBody.childNodes;        let indexRow = [...rowsList].indexOf(row);        dynamicDateArr[indexRow].title = editPopupField.value;        row.querySelector(".table-todo__title").innerHTML = editPopupField.value;        localStorage.setItem("rowsKey", JSON.stringify(dynamicDateArr));        closeEditPopup();    }    editPopupBtnCancel.addEventListener("click", closeEditPopup);    editPopupBtnClose.addEventListener("click", closeEditPopup);    function openEditPopup(title) {        popupEdit.classList.add("_open");        body.style.overflowY = "hidden";        editPopupField.value = title;        body.style.paddingRight = "15px";    }    function closeEditPopup() {        popupEdit.classList.remove("_open");        body.style.overflowY = "auto";        body.style.paddingRight = null;    }    editPopupOverlay.addEventListener("click", closeEditPopup);    // for all checkboxes    commonInputStatus.addEventListener("click", () => {        let inputsList = [...tableBody.querySelectorAll(".table-todo__status input")];        let rowsList = [...tableBody.childNodes];        if (commonInputStatus.checked === true) {            inputsList.filter(el => el.checked === false).forEach((el,i) => {                el.checked = true;                rowsList[i].classList.add("_done");                dynamicDateArr[i].status = true;                taskCommonStatus = true;            });        } else {            inputsList.filter(el => el.checked === true).forEach((el,i) => {                el.checked = false;                rowsList[i].classList.remove("_done");                dynamicDateArr[i].status = false;                taskCommonStatus = false;            });        }        localStorage.setItem("rowsKey", JSON.stringify(dynamicDateArr));        localStorage.setItem("taskCommonStatusKey", JSON.stringify(taskCommonStatus));    });});